(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     54092,       1239]
NotebookOptionsPosition[     50118,       1173]
NotebookOutlinePosition[     50482,       1189]
CellTagsIndexPosition[     50439,       1186]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Example of fitting MG numerator on a 2-dimensional polynomial in the loop \
momenta energies.\
\>", "Title",
 CellChangeTimes->{{3.7807966586323357`*^9, 3.7807967073899517`*^9}, {
  3.7962982928479967`*^9, 3.796298295554708*^9}, {3.796302489903371*^9, 
  3.796302491325037*^9}, {3.7982705376000853`*^9, 3.798270543160346*^9}, {
  3.798277200663225*^9, 
  3.798277222412553*^9}},ExpressionUUID->"862fd90a-3f33-4861-845a-\
877f7ac86f05"],

Cell["First Load up the MadGraph from Mathematica module:", "Text",
 CellChangeTimes->{{3.796277974983192*^9, 3.7962780038292923`*^9}, {
  3.7963024986625566`*^9, 3.796302506892592*^9}, {3.7982772978190327`*^9, 
  3.798277301028697*^9}},ExpressionUUID->"9131fffc-91c9-48f2-8761-\
6292b0a1a437"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "LTDPath", "=", 
   "\"\</Users/valentin/Documents/MG5/3.0.2.py3/PLUGIN/alphaloop\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.798277225936923*^9, 3.7982772283638763`*^9}, {
  3.7982772713166103`*^9, 
  3.7982772726146708`*^9}},ExpressionUUID->"7de1c9d8-cb26-47e9-8fcb-\
8b5323b434e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"LTDPath", "<>", "\"\</Mathematica/MGFromMathematica.m\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.79630250899262*^9, 3.79630251425735*^9}, 
   3.796302698146188*^9, 3.796302760938518*^9, {3.796302904493197*^9, 
   3.796302924683069*^9}, {3.798270555618122*^9, 3.798270555762179*^9}, {
   3.7982772780929213`*^9, 
   3.798277292306284*^9}},ExpressionUUID->"1cb01a94-6c0a-49a0-831a-\
6f1cd87e1b31"],

Cell[BoxData[
 FormBox["\<\"\\nPackage for accessing MadGraph Fortran numerators from \
Mathematica.\\n\\nNote that a MG5aMC process folder are generated from the \
MG5aMC alphaLoop plugin, for example with:\\n./bin/mg5_aMC --mode=alphaloop \
PLUGIN/alphaloop/examples/epem_jjj.aL\\n\\nThe function: \
\\nMGFM$GetLTDHook[OutputProcessRootPath_,OptionsPattern[\\n{\\nDEBUG->False\\\
n}\\n\\nAllows you to generate a hook for that process output, which will \
automatically be placed in the list:\\n\\nMGFM$AllHooksStarted\\n\\nThen you \
can test that one hook is active \
with:\\n\\nMGFM$CheckHookStatus[hook_]\\n\\nAnd use them to access \
information from Rust with the following three API entry points (for now):\\n\
\\nMGFM$GetMGNumerator[hook_, ComplexMomenta_, \
OptionsPattern[DEBUG->False]]\\n\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.798277292729157*^9, 
  3.798277849229784*^9},ExpressionUUID->"7913f142-4451-4b70-ae92-\
49bf61b8f0a2"]
}, Open  ]],

Cell["\<\
Copy-paste below the Process output directory path.
For example the one below was obtained by running:

./bin/mg5_aMC PLUGIN/alphaloop/examples/epem_a_ddxg.aL\[LineSeparator]cd \
TEST_epem_a_ddxg/SubProcesses && make
\
\>", "Text",
 CellChangeTimes->{{3.798270612088944*^9, 3.798270649260643*^9}, {
  3.79827068303443*^9, 3.798270686674417*^9}, {3.798271155766522*^9, 
  3.7982711587501383`*^9}},ExpressionUUID->"335a5b50-5a24-4240-91d3-\
673def06c326"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "ExampleProcOutputPath", " ", "=", " ", 
   "\"\</Users/valentin/Documents/MG5/3.0.2.py3/TEST_epem_a_ddxg\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7982705835923023`*^9, 3.798270607242154*^9}, 
   3.7982711924987717`*^9},ExpressionUUID->"48630be6-9b6d-4fe9-8827-\
ac59d5b274d4"],

Cell["Now obtain a hook for these MG numerators:", "Text",
 CellChangeTimes->{{3.798271199438718*^9, 3.798271219471554*^9}, {
  3.798277317540309*^9, 
  3.798277318519417*^9}},ExpressionUUID->"ff9af223-3f92-413c-a15e-\
24da5de7f653"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MGHook", " ", "=", " ", 
   RowBox[{"MGFM$GetLTDHook", "[", 
    RowBox[{"ExampleProcOutputPath", ",", 
     RowBox[{"DEBUG", "\[Rule]", "False"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.798271221236062*^9, 
  3.7982712369618063`*^9}},ExpressionUUID->"ac899e56-37b3-4844-b613-\
139b45f8b272"],

Cell["\<\
This hook is automatically added to the list MGFM$AllHooksStarted and its \
availability can be checked at any time with:\
\>", "Text",
 CellChangeTimes->{{3.798271239190515*^9, 3.798271280352498*^9}, 
   3.7982773252351027`*^9},ExpressionUUID->"c5462f3f-1378-4742-9223-\
d32bc1cb367f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MGFM$CheckHookStatus", "[", "MGHook", "]"}], "\n", 
 RowBox[{"MGFM$CheckHookStatus", "[", 
  RowBox[{"MGFM$AllHooksStarted", "\[LeftDoubleBracket]", 
   RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.798271290745698*^9, 
  3.798271296473379*^9}},ExpressionUUID->"eba75ea8-2722-4b1d-923b-\
4cfe08bd1043"],

Cell[BoxData[
 FormBox["True", TraditionalForm]], "Output",
 CellChangeTimes->{3.798271297399139*^9, 3.798277428918432*^9, 
  3.798277488192993*^9, 
  3.798277849425583*^9},ExpressionUUID->"562a2074-7ba0-454a-b23e-\
5a4fd5d7833c"],

Cell[BoxData[
 FormBox["True", TraditionalForm]], "Output",
 CellChangeTimes->{3.798271297399139*^9, 3.798277428918432*^9, 
  3.798277488192993*^9, 
  3.7982778495353603`*^9},ExpressionUUID->"a45ab2d8-4861-4752-bac2-\
3dff1388de41"]
}, Open  ]],

Cell["\<\
Now we can call the numerator for a specific process ID, diagram IDs and \
complex momenta configuration.\
\>", "Text",
 CellChangeTimes->{{3.798271300097288*^9, 3.798271301531972*^9}, {
  3.7982713663067217`*^9, 3.7982714045537243`*^9}, {3.798277335969378*^9, 
  3.798277336582717*^9}},ExpressionUUID->"a93104a1-9b30-4375-8fba-\
4ede4874057c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConvertMomentumToMathematica", "[", "strMom_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"aNumber", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*^\>\""}], "}"}]}], "]"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"aNumber", ",", " ", 
         RowBox[{"StringSplit", "[", "strMom", "]"}]}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",ExpressionUUID->"d3f9bccd-\
5d4d-4ee6-b512-fd927b63d83c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComplexKinematicConfiguration", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"500.0", ",", "0.", ",", "0.", ",", "500.0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"500.0", ",", "0.", ",", "0.", ",", 
       RowBox[{"-", "500.0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "ConvertMomentumToMathematica", "[", 
      "\"\<0.4585787878854402E+03   0.1694532203096798E+03   \
0.3796536620781987E+03  -0.1935024746502525E+03\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "ConvertMomentumToMathematica", "[", 
      "\"\<0.3640666207368178E+03  -0.1832986929319185E+02  \
-0.3477043013193671E+03   0.1063496077587081E+03\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "ConvertMomentumToMathematica", "[", 
      "\"\<0.1773545913777421E+03  -0.1511233510164880E+03  \
-0.3194936075883155E+02   0.8715286689154436E+02\>\"", "]"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.798271498829589*^9, 3.7982715076003647`*^9}, {
  3.798272100751007*^9, 3.798272127180915*^9}, {3.798272200301169*^9, 
  3.7982722503558397`*^9}, {3.7982773436146193`*^9, 
  3.798277344342787*^9}},ExpressionUUID->"8a897906-6230-4be6-8595-\
3969f88f102f"],

Cell["And define the function we want to fit:", "Text",
 CellChangeTimes->{{3.798277352806119*^9, 
  3.7982773650470324`*^9}},ExpressionUUID->"a5a09203-a496-4f2d-8958-\
6530f7410ac8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyF", "[", 
   RowBox[{
    RowBox[{"k0_", "?", "NumberQ"}], ",", 
    RowBox[{"l0_", "?", "NumberQ"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"kinConfig", "=", "ComplexKinematicConfiguration"}], ",", 
      RowBox[{"pID", "=", "0"}], ",", 
      RowBox[{"dIDs", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", "res"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "kinConfig", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", "k0"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "kinConfig", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", "l0"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"MGFM$GetMGNumerator", "[", 
       RowBox[{
        RowBox[{"MGFM$AllHooksStarted", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ",", "\n", "pID", ",", "dIDs", 
        ",", "\n", "kinConfig", ",", "\n", 
        RowBox[{"DEBUG", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Re", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.798274229919023*^9, 3.798274336727571*^9}, {
  3.798274661200753*^9, 
  3.798274677655285*^9}},ExpressionUUID->"fbd794dd-f7fa-418c-a864-\
22dcf4138012"],

Cell["\<\
As well as the basis which is the most generic polynomial of a given maximal \
rank:\
\>", "Text",
 CellChangeTimes->{{3.798277368565949*^9, 
  3.798277380447892*^9}},ExpressionUUID->"7ddafd91-24b4-4956-9ee1-\
3e7e1b8edfde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenericPolynomial", "[", 
   RowBox[{"vars_", ",", "maxRank_"}], "]"}], ":=", 
  RowBox[{"Join", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Times", "@@", "elem"}], ",", 
       RowBox[{"{", 
        RowBox[{"elem", ",", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"IntegerPartitions", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", "rank", "}"}], ",", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", "vars", "]"}], "]"}]}], "]"}], "&"}], 
             "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"rank", ",", 
               RowBox[{
                RowBox[{"Length", "[", "vars", "]"}], "*", "rank"}]}], 
              "]"}]}], ",", "1"}], "]"}], "/.", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[Rule]", 
             RowBox[{
             "vars", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
             ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}]}], 
        "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"rank", ",", "0", ",", "maxRank"}], "}"}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.798276223301363*^9, 3.798276223306745*^9}, {
  3.798276263870102*^9, 3.798276266369377*^9}, {3.798276300199986*^9, 
  3.7982763741472397`*^9}, {3.7982764392213593`*^9, 3.7982764512808323`*^9}, {
  3.7982764818781347`*^9, 3.79827650751329*^9}, {3.79827663821605*^9, 
  3.798276662956416*^9}, {3.798276702398801*^9, 
  3.798276702580113*^9}},ExpressionUUID->"fa15b70b-0e20-4026-b849-\
5adf074f679c"],

Cell["We can now generate the data which we will feed to the fit:", "Text",
 CellChangeTimes->{{3.7982773987600594`*^9, 
  3.798277411041791*^9}},ExpressionUUID->"9810aaa8-d163-4947-9511-\
930a54e03cd0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dataToFit", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k0", ",", "l0", ",", 
          RowBox[{"MyF", "[", 
           RowBox[{"k0", ",", "l0"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k0", ",", "0", ",", "1000.", ",", "100."}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"l0", ",", "0", ",", "1000.", ",", "100."}], "}"}]}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.798274696809461*^9, 3.79827470790372*^9}, {
  3.798274763688807*^9, 3.798274814254583*^9}, {3.798274981018548*^9, 
  3.798275035818821*^9}, {3.7982750779289703`*^9, 
  3.798275085803403*^9}},ExpressionUUID->"0b1c8d19-f44f-4a95-aa7e-\
cf0702894b50"],

Cell["\<\
Now let us fit the above, first with the wrong maximal rank (3):\
\>", "Text",
 CellChangeTimes->{{3.79827750533533*^9, 
  3.798277528076178*^9}},ExpressionUUID->"6a31d113-8438-4780-8393-\
a37b70ab35b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lm3", "=", 
  RowBox[{"LinearModelFit", "[", 
   RowBox[{"dataToFit", ",", 
    RowBox[{"GenericPolynomial", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k0", ",", "l0"}], "}"}], ",", "3"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k0", ",", "l0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.798276889041834*^9, 3.79827689885546*^9}, {
  3.798277134932633*^9, 3.798277135587893*^9}, {3.798277529744388*^9, 
  3.798277530378824*^9}},ExpressionUUID->"9889ce58-8236-4c92-a0ce-\
39e14b26c87f"],

Cell[BoxData[
 FormBox[
  TagBox[
   RowBox[{"FittedModel", "[", 
    TagBox[
     PanelBox[
      TagBox[
       RowBox[{
        RowBox[{"4.176540907779658`*^-8", " ", 
         SuperscriptBox["k0", "3"]}], "+", 
        RowBox[{"5.5827567712007836`*^7", " ", "l0", " ", 
         SuperscriptBox["k0", "2"]}], "-", 
        RowBox[{"6.136863601668961`*^9", " ", 
         SuperscriptBox["k0", "2"]}], "+", 
        RowBox[{"5.582756771200781`*^7", " ", 
         SuperscriptBox["l0", "2"], " ", "k0"}], "-", 
        RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
        RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
        RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
        RowBox[{
         RowBox[{"\[LeftSkeleton]", "22", "\[RightSkeleton]"}], " ", 
         SuperscriptBox[
          RowBox[{"\[LeftSkeleton]", "2", "\[RightSkeleton]"}], "3"]}], "-", 
        RowBox[{"6.1368636016689825`*^9", " ", 
         SuperscriptBox["l0", "2"]}], "+", 
        RowBox[{"8.909957439413521`*^12", " ", "l0"}], "+", 
        "1.8670250567021884`*^14"}],
       Short[#, 2]& ],
      FrameMargins->5],
     Editable -> False], "]"}],
   InterpretTemplate[
   FittedModel[{
     "Linear", {1.8670250567021884`*^14, 8.69018531398888*^12, 
      8.909957439413521*^12, -6.136863601668961*^9, -2.8849348886989124`*^10, \
-6.1368636016689825`*^9, 4.176540907779658*^-8, 5.5827567712007836`*^7, 
      5.582756771200781*^7, 
      4.691007642522168*^-8}, {{$CellContext`k0, $CellContext`l0}, {
       1, $CellContext`k0, $CellContext`l0, $CellContext`k0^2, \
$CellContext`k0 $CellContext`l0, $CellContext`l0^2, $CellContext`k0^3, \
$CellContext`k0^2 $CellContext`l0, $CellContext`k0 $CellContext`l0^2, \
$CellContext`l0^3}}, {0, 0}}, CompressedData["
1:eJxTTMoPSmViYGBgBOJKBhj4YD9Kj9Kj9NClAdI2kV0=
     "], CompressedData["
1:eJxl1AlM03cUwPEOEFSYonIM54HcFJGiyFGxPo6CS5Ei2sK/4jBUwWIXUSe2
eI0iYjPN34EIQxyoIExkGuY1RFBDPWAcbqJTOVwQFpYJ8+JoRPZbYE1+bySk
6TfQP3zy3luQsDV6kxGHw1GTb2PO/78u9DW3HWudETL+joH/+tGi9lC9t9VE
Vxj6mElMZvxTm/F+c7uhj9oJ8urv2038vNrQ0zu/SXPnzB3vsN/Qxe7f294V
2E98jsbQHa/XyUbsHcb780xDv1ly+GCFi9PE52sN3al3+okOsct4tz9s6KL9
n+WzhW4Tz2UNXZASsO+WhUcIrcBAhu1Zp/50K+TAgHPCxqiVbXbIgYH5V6cO
RbfMRw4MBHwdYWHm74gcGLC4mfW05pkLcmDAXO/b2/ALFzkwwA+QeXnP9UIO
DDTUDj/d1eGNHBg4Iv8QaCz1QQ4M9EytvcEf9kUODDy85Ld+Xn0AclBA99u+
0PA0W+SggCzb5C1nptsjBwWouPlmD82ckYMC+EvGUi+XcpGDAvryW9rPfMlD
DgpwnFWTJOxbghwUEDZZGFd30Q85KECiSq6e0bgMOSig3NsmaN4cQA4KKNio
ezJ/TzByUIBRW3DZkUlC2oH8H4/TC3yLf5pNO5DONbb5S5/lSDuQ7jvQnXih
iUs7kFeN5plu8Lg37UB65OnwStlaX9qB9PfSKwrjomW0A+lhrTl7VdeBdiA9
o67p4oz+ENqBdK+RQ5GrksJpB9Ij9uqkHq4i2oH0LlHG/QpPMZoHNUhqr44M
r5iH5kEN+jdLz51b44rmQQ09ay/9fLKQh+ZBDSIOvzRmsy+aBzUsel/RafTx
cjQPaljplFkjFgajeVDDte3c6uMpYWge1JDcJ9wsnSxC86CGhfVb5OGmUWge
1KArG/izqDYazYMa9hX90OBTKaEdyN+1uM3+brnpAtqB9Nd990urtnvQDqTb
eeaIA519aAfS3848wYzeWUY7kB6yZp9/pDiYdiCvA2+eNVhIw2kH0lO39Mqr
hyJoB9L/bm9O9yhYTTuQnj3AkbyaJKEdSC/7QluxqC6WdiDdJWZzZrcuDu0F
eb7jHP1DS0fagXS7ngedM3u80F5ogP/VtMAfOf5oLzQQvH7/qx1PAO2FBi63
zqnKORCG9kIDqQVdXdc+WoX2QgNhHfIb29yi0V5oYGd+8q0pAVK0Fxpo/mC8
p6RKhvZCA5GWvJdBufFoLzSwO3HX1G0pCbQDeU7uvSbrdIEz7UD61ddnz22S
LKYdSA+NdMk28gqkHUjfs7uq2NwmlHYgPSHVu321i4h2IL3f/N6oe8lq2oH0
Ia+ksckCKe3w73NdB1/rNqyjHUh/qeIreQc30A6kt9999VhZLKcdSN/GORX4
yVgiug9aeKdbOruSdaUdSN/57juT/t990H3QQrHopZt1LKD7oAX3F4nVwm/D
0X0g3eHzdaGzo9B90ILllcFpA1YSdB+00OI5OnS6RobugxbO1/ubXzy0Ad0H
LcheuC/NmbIR3QctvH33YET/PAndBy2oRnjMH9OUtAP5PdtP15oxJlzagfQm
fdReh3w/2oF0tjJ3ufXtYNqBdGFeocBBLqIdSA862Wlf+DiadiD9dOPuMx6/
xtIOpDc+ci5bURJPO5AeG99vrSyV0w6kXw5qzU/rTqIdyKsy2z9OdFhJO5B+
p3wWb6AlBd1JFkzvuXUcKFyI7iQL1UY3rIxVfHQnWRiOsMhKlwjRnWTh0bE1
nqd2iGkH0lMXFgh4jRJ0J1koiYi53tUZh+4kC6rclINb0xLQnWThfPcJuzzT
JHQnWRg86pnXO0uJ7iQLZc3ZY4sepKA7yYLM5Hb5h992hPwD6qiQFg==
     
     "], CompressedData["
1:eJytml+I1FUUxyeXwISVWhk0QlkdBFHwqZdeanwJAlEoEIwarDAYHwy1lPHB
1mnVHYgZRFIUErYtl40UZLM1yXVlkyTaigokSDCWwJfAiCgfhGx+3+8595x7
b81DF+TC6v14zj2/7+/8+e3Kl197dvuCUqnUuP9nUYnrzlOl/3WRt7Vqfjwy
W43+6f01NLx+Q2+8uuPNZ3i13ngzu+35u38keV9dafRoX8PZ15c8NzTc7o1X
fdPwhoYXJ89tn3u3R3+b1r675eS5r65M9Ma7dcjwqreXp87NzO76uMf7a1n7
RiqZ+5vujTf4tuENXlyTOjf4w6fXeoxHx/Byz+32ubke/eVyOuHK6CX+/73e
sPO823kut8d6Iw96G/ne8Wo4vwn7k2me6A086m3jTcOj3kbWvtTdt80/nbGP
eqN90JvYSfvaOL/T2el4oretOAe97bhteNTb8I193f3bgecy/jadv9Dbxl+d
vxPw9yD83ZLmid4Knuht6W8hT/S2+8Uj3f3O5POZ+2sZnuht5Hd3f9M4z3us
pXmit4InemOcC57o7cfNx0yc43h0DE/+fsdfxj7qbfjGCcTjlYy/XC6PcGXy
CZfmFa+3urFH9TFv7FZdbDL3GOutbs77Xe8/vcd6A0/0xuev4KneduH5ezVj
H/VG+6g3Pi+0j8/JAac7xxO91XFusYtvwVO9HUF892T8bTp/qbd7zl/q7Sj8
3Zvmid4KnurtgfA9E+jtBPS2P3N/LcNTvdn3lurttLtHxxO9FTzV24MhL9Db
mHnPxPHoGJ7qbaGxT/U2jni8lfEXy9dZXJl6i0vrLqc38qg35g/waDfzBt8v
Ma/ueNAZ9SG8mtEFdRLxyOFO/9zOc7k90pvY12efZ7GvDfsOm/hGPOoNPOpt
aPMC856m3sZ+LvSx9o1DGX+bzt+yff7E3wmcP4m9leZRb+BRb0PvPRTyqLeh
8uHR7s93Lmpn7q/l7g9629hv7KPets2fMe+FiEe9gUe9zex/OORRb0PX/vzI
5Lk4Hh3DkzyxecDFYw7xOI94vJPxl8v1IVyZfoRL+xKf38CT/MZ81GfyrOY1
vu89j/mt4TjMH+TVHOdAmifvFfAkv90zPM1vrK8OZ+zjvTXMeb9rfkvvcX4r
eJrfFhqe5jfWL8cy/jadv8xv/Yan+W0U/h5P8yS/FTzNb4+EvCC/jSO/ncrc
X8vwNL8tcffH/HbO5TnHk/xW8DS/lUNekN8mjd9xPDqGp/ltmYsH89sU4jGW
8RfL9elcuX6dS/t2pzfyqDf0H/K+ht3sO9iHxLy640FvqK+UVwNvD3hH0jzq
jTy+P5E/yKPemDeYR2L7Gs6+PqMPta9tdEGdRDxysOt5u/Ncbo/0Jv6WzftZ
/Z2Avx/A39E0j3oDj3qbeaEc8iS/ff342e5+7Kf3M/fXcvdXMc+z+j2N+5vE
/Y2nedQbeNRbdd9jIY96q35Tudi17/XvPszEo2N4midWuHjMYb+M/WzGXyw/
x+LKzLO4dK7l60nwpJ5k/ce4sJ7cYvJIzGM9SR70JvUaeawn94J3NM2TehI8
qSNZX5WN3rSuOpmxr2F5Uk/2G57Wk8fN+zTiST1Z8LSeHDA8rSdHjU5if5vO
3/KG1K71ZHqP68mCp/XkoyEvqCeL+mrnonOZ+2sZntaTy939sZ78BPd3Ps2T
erLgaT05GPKCevKz7s+Z5+J4dAxP68lVLh6sJ68iHhcy/mK5OS9XZt7LFcx9
nd7Io94wv5L4wG7OrTDHSvDqjge9oT9XXg28/eCdSPOoN/KY39B/kEe9oe9g
H5Kwr+Hsg95QX6l9bdh3CvaNp3nUG3jUG/MHedAb8wbzSMLfpvO3bPSh/k6E
uqBOYh452Hne7TyX20uR3uT+oLelK939TeP+LuH+ptI86g086u3WE5WQR73d
uvnLzD97dfCZS5l4dFw81iMeq1085hCPzxGPyxl/udx3EK7M9xAu/S7i+zfw
pH9jv1UxetO+q23uNe7fyIPepD+qOA77ttNpnvRv4En/1m942r9xXncmY1/D
8sSuJc6+trPrXJondX3B0/5tmeFp/8Z52GTG36bzl/3bcucv+7fzJo9EPHkv
Fzzt31aGvKB/mzI6ie+vZXjav1Xc/U3/6x73bwVP+7fVIS/o32bh99VMPDqG
p/3bGhcP9m9fIB6zGX+x3HdC+XH6e6H8tX43dHojj3rDc00e7eZcEvOhBK/u
eNAb6j/l1cA7CN5Ymke9kQe7OL8ij3qDXZxjJexrOPugNzzXal8b9o2CO5nm
UW/gUW/sP8hjfkPfwT4k4W/T+VvYxfpK/Z0I7WKdFfOoN/CoN+YP8Kg35g3m
kcT9tdz9VYw+9P6mjS6gk5hHDnaedzvP5fZSpDeJx3rEY52Lxxzi8SXicT3j
L5b7js71X78Hot/V/bwEPJmXcL5hv2vzu6DODzyv7njQm8wjbJ7kdw/tpx1P
5iXgybxkwPB0XlLMdTnnje1rWJ7MS5Y5+zgvGYN9U2mezEs6uC/OC1YYns5H
2JdfzvjbdP5yXrLK+ct5yQX4ezXNk3lJwdN5yeqQF8xLunaxzkrcX8vwdF6y
xt0f5yWzJo9EPJmXFDydl6wLecG85Hqok0Q8OoaX+/0MnZfE+98T/47y
     "], 
     Function[Null, 
      Internal`LocalizedBlock[{$CellContext`k0, $CellContext`l0}, #], {
      HoldAll}]]& ],
   Editable->False,
   SelectWithContents->True,
   Selectable->True], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.798276899752205*^9, 3.798277135914214*^9, {3.79827753101492*^9, 
   3.798277554678363*^9}, 
   3.798277849753306*^9},ExpressionUUID->"708579d1-dca1-4c88-bc6b-\
6faadb6eb7f3"]
}, Open  ]],

Cell["And then with the correct one (max_rank=4):", "Text",
 CellChangeTimes->{{3.798277533632765*^9, 
  3.7982775428991537`*^9}},ExpressionUUID->"e11d9445-5135-413a-a3a3-\
d56858899411"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lm4", "=", 
  RowBox[{"LinearModelFit", "[", 
   RowBox[{"dataToFit", ",", 
    RowBox[{"GenericPolynomial", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k0", ",", "l0"}], "}"}], ",", "4"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k0", ",", "l0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7982775473545513`*^9, 
  3.798277552613603*^9}},ExpressionUUID->"27841437-0540-42e2-83d6-\
e9aed8ba9bb4"],

Cell[BoxData[
 FormBox[
  TagBox[
   RowBox[{"FittedModel", "[", 
    TagBox[
     PanelBox[
      TagBox[
       RowBox[{
        RowBox[{"3.957723772844107`*^-12", " ", 
         SuperscriptBox["k0", "4"]}], "+", 
        RowBox[{"7.464131037957287`*^-11", " ", "l0", " ", 
         SuperscriptBox["k0", "3"]}], "+", 
        RowBox[{"2.6152059016077606`*^-8", " ", 
         SuperscriptBox["k0", "3"]}], "+", 
        RowBox[{"47417.80269160733`", " ", 
         SuperscriptBox["l0", "2"], " ", 
         SuperscriptBox["k0", "2"]}], "+", 
        RowBox[{"\[LeftSkeleton]", "9", "\[RightSkeleton]"}], "+", 
        RowBox[{"9.758068020721539`*^8", " ", 
         SuperscriptBox["l0", "2"]}], "+", 
        RowBox[{"1.7972870356724036`*^12", " ", "l0"}], "+", 
        "1.2536030662313898`*^15"}],
       Short[#, 2]& ],
      FrameMargins->5],
     Editable -> False], "]"}],
   InterpretTemplate[
   FittedModel[{
     "Linear", {1.2536030662313898`*^15, 1.5775149102478345`*^12, 
      1.7972870356724036`*^12, 9.758068020721205*^8, 1.856845380461817*^10, 
      9.758068020721539*^8, 2.6152059016077606`*^-8, 8.409765020400478*^6, 
      8.409765020400511*^6, -2.9153114968742248`*^-8, 3.957723772844107*^-12, 
      7.464131037957287*^-11, 47417.80269160733, 4.175927680216395*^-11, 
      2.886810281368643*^-11}, {{$CellContext`k0, $CellContext`l0}, {
       1, $CellContext`k0, $CellContext`l0, $CellContext`k0^2, \
$CellContext`k0 $CellContext`l0, $CellContext`l0^2, $CellContext`k0^3, \
$CellContext`k0^2 $CellContext`l0, $CellContext`k0 $CellContext`l0^2, \
$CellContext`l0^3, $CellContext`k0^4, $CellContext`k0^3 $CellContext`l0, \
$CellContext`k0^2 $CellContext`l0^2, $CellContext`k0 $CellContext`l0^3, \
$CellContext`l0^4}}, {0, 0}}, CompressedData["
1:eJxTTMoPSmViYGBgBOJKBhj4YD9Kj9Kj9NClAdI2kV0=
     "], CompressedData["
1:eJxl1AlM03cUwPEOEFSYonIM54HcFJGiyFGxPo6CS5Ei2sK/4jBUwWIXUSe2
eI0iYjPN34EIQxyoIExkGuY1RFBDPWAcbqJTOVwQFpYJ8+JoRPZbYE1+bySk
6TfQP3zy3luQsDV6kxGHw1GTb2PO/78u9DW3HWudETL+joH/+tGi9lC9t9VE
Vxj6mElMZvxTm/F+c7uhj9oJ8urv2038vNrQ0zu/SXPnzB3vsN/Qxe7f294V
2E98jsbQHa/XyUbsHcb780xDv1ly+GCFi9PE52sN3al3+okOsct4tz9s6KL9
n+WzhW4Tz2UNXZASsO+WhUcIrcBAhu1Zp/50K+TAgHPCxqiVbXbIgYH5V6cO
RbfMRw4MBHwdYWHm74gcGLC4mfW05pkLcmDAXO/b2/ALFzkwwA+QeXnP9UIO
DDTUDj/d1eGNHBg4Iv8QaCz1QQ4M9EytvcEf9kUODDy85Ld+Xn0AclBA99u+
0PA0W+SggCzb5C1nptsjBwWouPlmD82ckYMC+EvGUi+XcpGDAvryW9rPfMlD
DgpwnFWTJOxbghwUEDZZGFd30Q85KECiSq6e0bgMOSig3NsmaN4cQA4KKNio
ezJ/TzByUIBRW3DZkUlC2oH8H4/TC3yLf5pNO5DONbb5S5/lSDuQ7jvQnXih
iUs7kFeN5plu8Lg37UB65OnwStlaX9qB9PfSKwrjomW0A+lhrTl7VdeBdiA9
o67p4oz+ENqBdK+RQ5GrksJpB9Ij9uqkHq4i2oH0LlHG/QpPMZoHNUhqr44M
r5iH5kEN+jdLz51b44rmQQ09ay/9fLKQh+ZBDSIOvzRmsy+aBzUsel/RafTx
cjQPaljplFkjFgajeVDDte3c6uMpYWge1JDcJ9wsnSxC86CGhfVb5OGmUWge
1KArG/izqDYazYMa9hX90OBTKaEdyN+1uM3+brnpAtqB9Nd990urtnvQDqTb
eeaIA519aAfS3848wYzeWUY7kB6yZp9/pDiYdiCvA2+eNVhIw2kH0lO39Mqr
hyJoB9L/bm9O9yhYTTuQnj3AkbyaJKEdSC/7QluxqC6WdiDdJWZzZrcuDu0F
eb7jHP1DS0fagXS7ngedM3u80F5ogP/VtMAfOf5oLzQQvH7/qx1PAO2FBi63
zqnKORCG9kIDqQVdXdc+WoX2QgNhHfIb29yi0V5oYGd+8q0pAVK0Fxpo/mC8
p6RKhvZCA5GWvJdBufFoLzSwO3HX1G0pCbQDeU7uvSbrdIEz7UD61ddnz22S
LKYdSA+NdMk28gqkHUjfs7uq2NwmlHYgPSHVu321i4h2IL3f/N6oe8lq2oH0
Ia+ksckCKe3w73NdB1/rNqyjHUh/qeIreQc30A6kt9999VhZLKcdSN/GORX4
yVgiug9aeKdbOruSdaUdSN/57juT/t990H3QQrHopZt1LKD7oAX3F4nVwm/D
0X0g3eHzdaGzo9B90ILllcFpA1YSdB+00OI5OnS6RobugxbO1/ubXzy0Ad0H
LcheuC/NmbIR3QctvH33YET/PAndBy2oRnjMH9OUtAP5PdtP15oxJlzagfQm
fdReh3w/2oF0tjJ3ufXtYNqBdGFeocBBLqIdSA862Wlf+DiadiD9dOPuMx6/
xtIOpDc+ci5bURJPO5AeG99vrSyV0w6kXw5qzU/rTqIdyKsy2z9OdFhJO5B+
p3wWb6AlBd1JFkzvuXUcKFyI7iQL1UY3rIxVfHQnWRiOsMhKlwjRnWTh0bE1
nqd2iGkH0lMXFgh4jRJ0J1koiYi53tUZh+4kC6rclINb0xLQnWThfPcJuzzT
JHQnWRg86pnXO0uJ7iQLZc3ZY4sepKA7yYLM5Hb5h992hPwD6qiQFg==
     
     "], CompressedData["
1:eJzFm39sleUVx6+URcXgoK4W3MpaCinDUYdpwli2etsxGRvYVdAOQyuonStL
2VTElD/ctSvQJsttsCqRZMRalXRRElK1aga2qQSzWGfckpslmMDYIllCAhOD
mLDs3vt+v89znvM+z33Tv/Yk5oRi34/nPOd+7/nxWvPAr+/unJVKpXry/3w1
xXPhjtT/5ZC7Oe38uH8qHftX8yfTV99U6ml9uQMl/z7O7VLcswFuRwI3NzPu
xKMu58rnXu4H7/aUeu68qW//d4b+9ric/jLv72f6sgn+VjbPiJv+rcPN9N3o
fX7n9B9KcV985pYVM+NO9Drc1JUK7/M/eHc0Ic6NM+Oe3uNw0+eqfM+fmHrk
9RLczAsDn/10ZtzUgMNN9dcG7vd4wv22zYxb/XuHW/3WMt/zq//29okS3Orf
bFzw4AzzatDhhvShc3o6Ia+6ZxhnHqVbPAH94knSMR6rZ1onYclRls8PWT43
ycZ1klzoZP9fFbcDnLtgGxU3B3sSdhz2sJ9rdBJc6uT6TxwudbJ/+bai3Xr2
TsmlTm7NVf2zYDM7P/5z8e9HzhwN+EudpL/QSeM3/c2Cs0P5TX8jnezLXVb+
j/u5Ric34/nQye3nHC51si/3RNF+VL5RcqmT53b9+NqCrb7/hX80Rb93LBDn
XhVn6OT68yrOo4jzU4jzvSrORZ3Mx/lrzVGc/404T/q5RicjrtHJyouSa3Ty
0fZ9RXth7D7BNTp5avLiNwt23jVN/yne89Cp9wL3S53k/UIn+z9z/KVO2nvu
kP4anezL1al7PunnGp2MuEYnmdcR1+jk31uGnLyOuEYn315x5TvNKZvfJq/j
eUWdZF5Bf7Z/4fhLneTvf1T+oMqrbuTVKuTVrGbf78V1UtVZPIF6iyep7uKx
9ZfWSXCNPlKvIq7VRerUXc49Wz2kPo2r+9Vc+knuWa+1eeS3VidK27hOgmt0
kp/fiGt18hF8fn8huUInLyGf+Pk9E/CXOkl/qZP8HNFffn6eVHpJf6mT16rP
0ad+rtHJLjyfOsl8jrhWJ/chnx+TXKGTlSqfzwfi3KviTJ28quJMndyPOO9S
caZOLoFOzmmO4nzRzzU6GXGtTl4jv5eETh6ATu4WXKmTt0Eny4v8oVOXAvdL
neT9Uifd70Ork4fUPfN+qZOrYP3fi3GdjLhWJ78iuUInR5zvpYgrdTINnVyE
eH8ZyCvqJPOKOnmd46/Vu8PIq9+pvKJOrkVeLUZeXQ3EGUf3hTyB/pAnoU/k
Ef2i0klyqZOsr8BlHFhX8fuIXOok6il+D7He8nC7FBf6SL0y3A5Hp6hblpuT
+kS9on7FueTRMq7K8vkBy+cm2VRMJ42/Za5uGH+z8Hevk8/W30roxHypG3l/
Z8s6IBXTSXCpk5mWWU2SS50cORPp1fLH90gudbJ+866agp39q0vF+u67G5Ze
7+dSJ02cK9zPr4nzKDjPww6oODfi+fXy85u3N/q51ElwqZOZF6+XXOpkpmLv
cPHnO+ZkBdfoZGfr50W9ur1moKjTO79xcL6fS5009wudXD/X8Zc6ufXsK873
g73fNtxvE+53uayn41zqJLjUyYnd8ySXOpk5cflV6OWQ4FInM8++9/g6WVeu
f3r45kBeDTpcU0e1lKu8mpa6kM+rZ1VedSOvWpFXDcirhYE486g5Fk9gnsWT
NNfisfMtXU+Ca+pJ6Ba4tp5kHck6J+vopK0jWc/xe1BzWU+SSx7rK3I7FO9J
xSXnU8VjvaW45nsIXFNPss4pc/LW9oN7JVfUk7NVnTPfzzX32uNwtLX1pN/a
+qK0jdeTEdfWk9c5XFtPsj8aklxRT9ap7/2qQJx7VZxZT851uLaeHEacn1Nx
Zj3ZIHUjH+caP9fUkxHX1pPzJVfUk1Gdc2HsoODKevIO1JO3o55cErhf1pO8
X9aTN6n7ZT15BPaQul/Wk2tVXVnn55p6MuLaerJCckU9OebEO+LKevJnzSLu
Jt7xvGI9ybxiPblA5RXryXHk1YjKK9aTbcirZuTVikCccdTcnSc0f+dJmMPz
iHm80klyqZOYX5n6A3Hg3IpzLP35wryK8yvOszzcLsWFTqIftNwOcB8DZ5/i
5vDn8+DOkv1hnEudJJff86ivyKVOsq5inQUudZL1FOsr1lsef3uUv2WOXll/
s45O2bjS30qpT9Qr6lecSx6s5biWzw9YPjfJpmI6aeJc4dQbNs6jiPPLiPOw
inMj6ovVst7Ix3mln0udBJc6ObGlQnJNPflhw2tFO3TqJcGlTma+tfDyDwvP
H92/5/sFe8Mv728I3O+Aut9aRzdsvI/jfsdwn4fV/bbhfjdI3eD8Ls6lToJL
nUw/8XXJpU6m/1L7VtHfnR//UXCpk+m6nlX3FPx+6Iunizp9Ys/K7wXyatDh
2jpqkcqraakLefuayqtuPL8ddgPsDwJxxtF7Qp7AvpAnYW/II/aHuu8G1/Td
7H+ZX+y778X3EfvBUefzjPm66H/ZL2gu+25yoZOmDyWXffcucPcrLvvui+Cy
D13i55q+G1zTb7MfrHB00vaBz0uu6K/Z/7EfrA/4y76b/rLvnutwbd/9nPO9
b/1l312j+rIGP9f03RHX9t3lDtf23cOOboEr+u6Vqj9aHYhzr4pzRZPP2r7b
a0XfXdKmYjoJru27F0qu6LujfnDHnCOCK/vuol7k++41BZvvu5sC9zvgcG3f
XaXul333m7jfo+p+2Xe34n5/gvtd4+eavjvi2r67WnJF3/2n4s9ZV0Zc2Xdv
lnVlvu++M5BXgw7X9t2LVV6x755EXr2h8op99zbk1Sbk1bpAnHHUew08gfcb
eBLec+CR7zsonSSXOon9oMkzxIF7QewJDRc6yX0g94PYF/q4XYoLncS83XI7
wN0N7gHFzYF7Cdxy9Eu3+bnUSXJZT2J+RS51EnMrzrHIpU5yXsX5FeZZPn97
lL/QSfSD1t8s/D0Ifw8rfytl/8d+EP2hh0udBJc6yfqKXOgk6yrWWeRSJ1lP
ob5iveWLc6+Kc4WjVzbOo1KnqFsizo1Sn6hX0C8PlzxYcpTl8wPW1JMJVt7v
gLpf6GRljbrf47jfd3C/4+p+23C/m3C/d+N+W/xc6iS41MnTq2sllzp5+pN/
TRRsunrdO4JLnZwom/d6oa5L//xHtxT+OyZuuHq5NZBXgw6X+jCxZanKq2mp
C/m8Oqbyqht59RDyagvyamMgzjzqPSyewPtYPEnvZfHY97P0fBJcM5/knLDW
0Uk7L8w6927nk9xvc07IuYrmcj5JLnTSzOtqFY9zyUOK65+D2rmO4pr5JLhm
PjnX4dr5JPewr0iumE/yfRXOzZoC/nI+SX/p503K36zy84jyl/7VKT/X+rlm
jhNx7XxygcO1fR/3kmOSK+aTfH+Dc6QNgTj3qjhzPlml4sz55FHE+U0VZ84n
18j6ivVWnGvqjIhr55M1kivmk+OObkVcOZ9skXpF/fLcLz+3vN/aJp+180m/
tfPJ0jY+n4y4dj65VHLFfHIK8Z4UXDmf3Io6rgPxvi+QV5xPMq84n1ym8orz
yZPIqymVV5xPPoy8egB51R6IM456b9T82P/+qPnr0u+Rmn9NvE+qdJJc6iT0
g1zGgXtu7MsMl/Uk9tzUEezNfNwuxYVOov+13A5wnwJ3RHFz4H4J7iLcd9rP
pU6SCz+5HySXOgk/uSckl/5xHwg/uS/0+duj/IVOQj+sv1n4Owz+mPK3Uuoy
dQR9kodLnQSXOsn5FbmsJzG34hyLXOok5lWcX3Ge5Ytzr4pz5Cf7QRvnUekn
+0IR50bZ/8FP9oceLnUSXOok6ytwqZOsq1hngUudZD1l6ivUW777HVD3W+vo
lb3f445OQbfE/bZJfaJeQb88XPJgyVGWzw9YPjfJCi510uRVPfLqVpVX01IX
8nn1vsqrbuTVduTVw8irzkCccdR77jxJ75EnvPfOI95/13sccM0eh/sU931y
vidq9wvTvj+LfQrnz5rLPQ650Emz13DrV753Zefe5HKPcxVc7jXW+rlmjwOu
2eOUO1y7x4neY+B7DeCKPU7x/QWxX2gN+Ms9Dv3lHmeB8pd7nBH4N6785R5n
hazruC+Mc80eJ+LafcIih2v3NpyzH5Ncsa/hfJ3z9vZAnHtVnLnHWazizD3O
G4jzpIoz9zjrEOdNiPM2P9fscSKu3eMslVyxxyn6ad4fj7hyj7NR9IOmP/Tc
74DDtXucZep+uceZwn2eVPfLPU67rK9Yb8W5Zo8Tce0e51bJFXuc96VugSv3
OJ1Cr6hfvrwadLih///E7nG8VuxxwvZ/uAS6xw==
     "], 
     Function[Null, 
      Internal`LocalizedBlock[{$CellContext`k0, $CellContext`l0}, #], {
      HoldAll}]]& ],
   Editable->False,
   SelectWithContents->True,
   Selectable->True], TraditionalForm]], "Output",
 CellChangeTimes->{{3.798277548173579*^9, 3.798277557140682*^9}, 
   3.7982778498177233`*^9},ExpressionUUID->"d245260d-07d1-424b-841e-\
df4a005e7e31"]
}, Open  ]],

Cell["\<\
We can look at some of the outcome properties of the fits we realized:\
\>", "Text",
 CellChangeTimes->{{3.798277561985939*^9, 
  3.798277573635359*^9}},ExpressionUUID->"2cf9bf65-cacc-47b0-a450-\
de92b3a5876b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lm3", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<RSquared\>\"", ",", "\"\<FitResiduals\>\"", ",", 
    "\"\<ANOVATable\>\""}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.798276958279509*^9, 3.798276958676511*^9}, 
   3.798277578171961*^9},ExpressionUUID->"e99d9cf0-914b-461f-aeb7-\
3fa5dad8a2ba"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0.9995925679003117`", ",", 
    RowBox[{"{", 
     RowBox[{"1.0669005605611849`*^15", ",", "4.2676022422448275`*^14", ",", 
      RowBox[{"-", "7.1126704037397`*^13"}], ",", 
      RowBox[{"-", "4.267602242244545`*^14"}], ",", 
      RowBox[{"-", "6.401403363366918`*^14"}], ",", 
      RowBox[{"-", "7.112670403741045`*^14"}], ",", 
      RowBox[{"-", "6.401403363366965`*^14"}], ",", 
      RowBox[{"-", "4.26760224224467`*^14"}], ",", 
      RowBox[{"-", "7.11267040374155`*^13"}], ",", "4.267602242244545`*^14", 
      ",", "1.066900560561147`*^15", ",", "4.267602242244795`*^14", ",", 
      "1.7070408968979725`*^14", ",", 
      RowBox[{"-", "2.845068161495575`*^13"}], ",", 
      RowBox[{"-", "1.707040896897795`*^14"}], ",", 
      RowBox[{"-", "2.560561345346755`*^14"}], ",", 
      RowBox[{"-", "2.845068161496435`*^14"}], ",", 
      RowBox[{"-", "2.5605613453468`*^14"}], ",", 
      RowBox[{"-", "1.70704089689791`*^14"}], ",", 
      RowBox[{"-", "2.8450681614972`*^13"}], ",", "1.70704089689771`*^14", 
      ",", "4.26760224224444`*^14", ",", 
      RowBox[{"-", "7.11267040374035`*^13"}], ",", 
      RowBox[{"-", "2.84506816149595`*^13"}], ",", "4.7417802691655`*^12", 
      ",", "2.8450681614967`*^13", ",", "4.2676022422446`*^13", ",", 
      "4.7417802691606`*^13", ",", "4.2676022422442`*^13", ",", 
      "2.8450681614955`*^13", ",", "4.741780269148`*^12", ",", 
      RowBox[{"-", "2.8450681614988`*^13"}], ",", 
      RowBox[{"-", "7.112670403744`*^13"}], ",", 
      RowBox[{"-", "4.2676022422446225`*^14"}], ",", 
      RowBox[{"-", "1.70704089689786`*^14"}], ",", "2.8450681614966`*^13", 
      ",", "1.70704089689786`*^14", ",", "2.56056134534679`*^14", ",", 
      "2.8450681614964`*^14", ",", "2.56056134534672`*^14", ",", 
      "1.70704089689778`*^14", ",", "2.845068161495`*^13", ",", 
      RowBox[{"-", "1.70704089689808`*^14"}], ",", 
      RowBox[{"-", "4.2676022422449`*^14"}], ",", 
      RowBox[{"-", "6.401403363366998`*^14"}], ",", 
      RowBox[{"-", "2.560561345346815`*^14"}], ",", "4.2676022422445`*^13", 
      ",", "2.56056134534677`*^14", ",", "3.84084201802014`*^14", ",", 
      "4.26760224224458`*^14", ",", "3.84084201802008`*^14", ",", 
      "2.56056134534668`*^14", ",", "4.2676022422426`*^13", ",", 
      RowBox[{"-", "2.560561345347`*^14"}], ",", 
      RowBox[{"-", "6.40140336336724`*^14"}], ",", 
      RowBox[{"-", "7.11267040374114`*^14"}], ",", 
      RowBox[{"-", "2.84506816149652`*^14"}], ",", "4.7417802691601`*^13", 
      ",", "2.84506816149635`*^14", ",", "4.2676022422445`*^14", ",", 
      "4.7417802691606`*^14", ",", "4.26760224224444`*^14", ",", 
      "2.84506816149624`*^14", ",", "4.7417802691576`*^13", ",", 
      RowBox[{"-", "2.84506816149668`*^14"}], ",", 
      RowBox[{"-", "7.11267040374152`*^14"}], ",", 
      RowBox[{"-", "6.40140336336708`*^14"}], ",", 
      RowBox[{"-", "2.560561345346905`*^14"}], ",", "4.2676022422436`*^13", 
      ",", "2.56056134534668`*^14", ",", "3.84084201802006`*^14", ",", 
      "4.26760224224448`*^14", ",", "3.84084201802008`*^14", ",", 
      "2.56056134534656`*^14", ",", "4.2676022422424`*^13", ",", 
      RowBox[{"-", "2.56056134534704`*^14"}], ",", 
      RowBox[{"-", "6.40140336336728`*^14"}], ",", 
      RowBox[{"-", "4.2676022422448`*^14"}], ",", 
      RowBox[{"-", "1.70704089689801`*^14"}], ",", "2.8450681614948`*^13", 
      ",", "1.70704089689774`*^14", ",", "2.56056134534658`*^14", ",", 
      "2.84506816149624`*^14", ",", "2.56056134534668`*^14", ",", 
      "1.70704089689768`*^14", ",", "2.8450681614936`*^13", ",", 
      RowBox[{"-", "1.70704089689824`*^14"}], ",", 
      RowBox[{"-", "4.26760224224504`*^14"}], ",", 
      RowBox[{"-", "7.11267040374285`*^13"}], ",", 
      RowBox[{"-", "2.8450681614985`*^13"}], ",", "4.741780269144`*^12", ",", 
      "2.845068161495`*^13", ",", "4.2676022422428`*^13", ",", 
      "4.741780269158`*^13", ",", "4.2676022422436`*^13", ",", 
      "2.8450681614928`*^13", ",", "4.741780269104`*^12", ",", 
      RowBox[{"-", "2.8450681615008`*^13"}], ",", 
      RowBox[{"-", "7.1126704037456`*^13"}], ",", "4.267602242244415`*^14", 
      ",", "1.70704089689762`*^14", ",", 
      RowBox[{"-", "2.8450681614992`*^13"}], ",", 
      RowBox[{"-", "1.70704089689808`*^14"}], ",", 
      RowBox[{"-", "2.560561345347`*^14"}], ",", 
      RowBox[{"-", "2.84506816149672`*^14"}], ",", 
      RowBox[{"-", "2.56056134534708`*^14"}], ",", 
      RowBox[{"-", "1.70704089689848`*^14"}], ",", 
      RowBox[{"-", "2.8450681615`*^13"}], ",", "1.7070408968972`*^14", ",", 
      "4.26760224224416`*^14", ",", "1.066900560561135`*^15", ",", 
      "4.26760224224436`*^14", ",", 
      RowBox[{"-", "7.112670403744`*^13"}], ",", 
      RowBox[{"-", "4.26760224224492`*^14"}], ",", 
      RowBox[{"-", "6.40140336336736`*^14"}], ",", 
      RowBox[{"-", "7.11267040374144`*^14"}], ",", 
      RowBox[{"-", "6.40140336336736`*^14"}], ",", 
      RowBox[{"-", "4.26760224224528`*^14"}], ",", 
      RowBox[{"-", "7.1126704037456`*^13"}], ",", "4.26760224224432`*^14", 
      ",", "1.06690056056112`*^15"}], "}"}], ",", 
    StyleBox[
     TagBox[GridBox[{
        {"\<\"\"\>", "\<\"DF\"\>", "\<\"SS\"\>", "\<\"MS\"\>", \
"\<\"F\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
        {"k0", "1", "1.5319621295705812`*^34", "1.5319621295705812`*^34", 
         "102733.85436526776`", "1.651290984171831`*^-166"},
        {"l0", "1", "1.5509448496430815`*^34", "1.5509448496430815`*^34", 
         "104006.84144617656`", "8.342709902355456`*^-167"},
        {
         SuperscriptBox["k0", "2"], "1", "4.475822905897451`*^32", 
         "4.475822905897451`*^32", "3001.5006879320727`", 
         "3.4189633135253275`*^-82"},
        {
         RowBox[{"k0", " ", "l0"}], "1", "8.296725923658884`*^33", 
         "8.296725923658884`*^33", "55638.10072698297`", 
         "9.504938377982069`*^-152"},
        {
         SuperscriptBox["l0", "2"], "1", "4.475822905897451`*^32", 
         "4.475822905897451`*^32", "3001.5006879320727`", 
         "3.4189633135253275`*^-82"},
        {
         SuperscriptBox["k0", "3"], "1", "0.`", "0.`", "0.`", "1.`"},
        {
         RowBox[{
          SuperscriptBox["k0", "2"], " ", "l0"}], "1", 
         "2.941557803443702`*^32", "2.941557803443702`*^32", 
         "1972.617763539038`", "1.6255318191547982`*^-72"},
        {
         RowBox[{"k0", " ", 
          SuperscriptBox["l0", "2"]}], "1", "2.941557803443748`*^32", 
         "2.941557803443748`*^32", "1972.6177635390688`", 
         "1.6255318191534811`*^-72"},
        {
         SuperscriptBox["l0", "3"], "1", "0.`", "0.`", "0.`", "1.`"},
        {"\<\"Error\"\>", "111", "1.6552264823797388`*^31", 
         "1.4911950291709358`*^29", "", ""},
        {"\<\"Total\"\>", "120", "4.062582412248754`*^34", "", "", ""}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
       GridBoxDividers->{
        "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
         "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       
       GridBoxSpacings->{
        "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
      "Grid"], "DialogStyle",
     StripOnInput->False]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.798276923234108*^9, 3.79827696338162*^9, 
  3.798277140530178*^9, 3.7982775787995358`*^9, 
  3.798277849872594*^9},ExpressionUUID->"4ca0bd6e-1093-4b66-8a6d-\
a9963912169e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lm4", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<RSquared\>\"", ",", "\"\<FitResiduals\>\"", ",", 
    "\"\<ANOVATable\>\""}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7982775898837337`*^9, 
  3.79827759088027*^9}},ExpressionUUID->"33747149-b5e7-4998-bb74-\
e96038ce1619"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"1.`", ",", 
    RowBox[{"{", 
     RowBox[{"14.`", ",", "5.5`", ",", 
      RowBox[{"-", "1.75`"}], ",", 
      RowBox[{"-", "8.25`"}], ",", 
      RowBox[{"-", "16.25`"}], ",", 
      RowBox[{"-", "21.`"}], ",", 
      RowBox[{"-", "26.5`"}], ",", 
      RowBox[{"-", "31.`"}], ",", 
      RowBox[{"-", "35.`"}], ",", 
      RowBox[{"-", "42.5`"}], ",", 
      RowBox[{"-", "47.5`"}], ",", "9.25`", ",", "1.5`", ",", 
      RowBox[{"-", "5.25`"}], ",", 
      RowBox[{"-", "11.`"}], ",", 
      RowBox[{"-", "17.`"}], ",", 
      RowBox[{"-", "23.5`"}], ",", 
      RowBox[{"-", "28.`"}], ",", 
      RowBox[{"-", "32.`"}], ",", 
      RowBox[{"-", "37.`"}], ",", 
      RowBox[{"-", "45.`"}], ",", 
      RowBox[{"-", "52.`"}], ",", "4.25`", ",", 
      RowBox[{"-", "3.5`"}], ",", 
      RowBox[{"-", "7.`"}], ",", 
      RowBox[{"-", "13.5`"}], ",", 
      RowBox[{"-", "19.`"}], ",", 
      RowBox[{"-", "23.`"}], ",", 
      RowBox[{"-", "29.`"}], ",", 
      RowBox[{"-", "35.`"}], ",", 
      RowBox[{"-", "40.`"}], ",", 
      RowBox[{"-", "50.`"}], ",", 
      RowBox[{"-", "60.`"}], ",", "1.75`", ",", 
      RowBox[{"-", "6.`"}], ",", 
      RowBox[{"-", "9.`"}], ",", 
      RowBox[{"-", "14.`"}], ",", 
      RowBox[{"-", "18.`"}], ",", 
      RowBox[{"-", "24.`"}], ",", 
      RowBox[{"-", "32.`"}], ",", 
      RowBox[{"-", "34.`"}], ",", 
      RowBox[{"-", "42.`"}], ",", 
      RowBox[{"-", "56.`"}], ",", 
      RowBox[{"-", "60.`"}], ",", 
      RowBox[{"-", "1.25`"}], ",", 
      RowBox[{"-", "7.5`"}], ",", 
      RowBox[{"-", "11.`"}], ",", 
      RowBox[{"-", "15.`"}], ",", 
      RowBox[{"-", "22.`"}], ",", 
      RowBox[{"-", "26.`"}], ",", 
      RowBox[{"-", "36.`"}], ",", 
      RowBox[{"-", "36.`"}], ",", 
      RowBox[{"-", "48.`"}], ",", 
      RowBox[{"-", "52.`"}], ",", 
      RowBox[{"-", "56.`"}], ",", 
      RowBox[{"-", "3.`"}], ",", 
      RowBox[{"-", "11.`"}], ",", 
      RowBox[{"-", "15.`"}], ",", 
      RowBox[{"-", "20.`"}], ",", 
      RowBox[{"-", "30.`"}], ",", 
      RowBox[{"-", "34.`"}], ",", 
      RowBox[{"-", "44.`"}], ",", 
      RowBox[{"-", "48.`"}], ",", 
      RowBox[{"-", "60.`"}], ",", 
      RowBox[{"-", "60.`"}], ",", 
      RowBox[{"-", "88.`"}], ",", 
      RowBox[{"-", "5.`"}], ",", 
      RowBox[{"-", "12.`"}], ",", 
      RowBox[{"-", "16.`"}], ",", 
      RowBox[{"-", "20.`"}], ",", 
      RowBox[{"-", "28.`"}], ",", 
      RowBox[{"-", "36.`"}], ",", 
      RowBox[{"-", "36.`"}], ",", 
      RowBox[{"-", "52.`"}], ",", 
      RowBox[{"-", "56.`"}], ",", 
      RowBox[{"-", "68.`"}], ",", 
      RowBox[{"-", "80.`"}], ",", 
      RowBox[{"-", "6.5`"}], ",", 
      RowBox[{"-", "12.`"}], ",", 
      RowBox[{"-", "19.`"}], ",", 
      RowBox[{"-", "20.`"}], ",", 
      RowBox[{"-", "32.`"}], ",", 
      RowBox[{"-", "40.`"}], ",", 
      RowBox[{"-", "36.`"}], ",", 
      RowBox[{"-", "48.`"}], ",", 
      RowBox[{"-", "64.`"}], ",", 
      RowBox[{"-", "88.`"}], ",", 
      RowBox[{"-", "88.`"}], ",", 
      RowBox[{"-", "5.5`"}], ",", 
      RowBox[{"-", "15.`"}], ",", 
      RowBox[{"-", "16.`"}], ",", 
      RowBox[{"-", "20.`"}], ",", 
      RowBox[{"-", "32.`"}], ",", 
      RowBox[{"-", "48.`"}], ",", 
      RowBox[{"-", "36.`"}], ",", 
      RowBox[{"-", "64.`"}], ",", 
      RowBox[{"-", "88.`"}], ",", 
      RowBox[{"-", "96.`"}], ",", 
      RowBox[{"-", "96.`"}], ",", 
      RowBox[{"-", "7.5`"}], ",", 
      RowBox[{"-", "15.`"}], ",", 
      RowBox[{"-", "24.`"}], ",", 
      RowBox[{"-", "24.`"}], ",", 
      RowBox[{"-", "32.`"}], ",", 
      RowBox[{"-", "48.`"}], ",", 
      RowBox[{"-", "56.`"}], ",", 
      RowBox[{"-", "104.`"}], ",", 
      RowBox[{"-", "72.`"}], ",", 
      RowBox[{"-", "136.`"}], ",", 
      RowBox[{"-", "128.`"}], ",", 
      RowBox[{"-", "8.`"}], ",", 
      RowBox[{"-", "16.`"}], ",", 
      RowBox[{"-", "24.`"}], ",", 
      RowBox[{"-", "28.`"}], ",", 
      RowBox[{"-", "48.`"}], ",", 
      RowBox[{"-", "56.`"}], ",", 
      RowBox[{"-", "72.`"}], ",", 
      RowBox[{"-", "104.`"}], ",", 
      RowBox[{"-", "96.`"}], ",", 
      RowBox[{"-", "112.`"}], ",", 
      RowBox[{"-", "144.`"}]}], "}"}], ",", 
    StyleBox[
     TagBox[GridBox[{
        {"\<\"\"\>", "\<\"DF\"\>", "\<\"SS\"\>", "\<\"MS\"\>", \
"\<\"F\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
        {"k0", "1", "1.5319621295705812`*^34", "1.5319621295705812`*^34", 
         "5.757091805977381`*^30", "0"},
        {"l0", "1", "1.5509448496430815`*^34", "1.5509448496430815`*^34", 
         "5.828428596930032`*^30", "0"},
        {
         SuperscriptBox["k0", "2"], "1", "4.475822905897451`*^32", 
         "4.475822905897451`*^32", "1.6820078564064078`*^29", "0"},
        {
         RowBox[{"k0", " ", "l0"}], "1", "8.296725923658884`*^33", 
         "8.296725923658884`*^33", "3.1178977540995427`*^30", "0"},
        {
         SuperscriptBox["l0", "2"], "1", "4.475822905897451`*^32", 
         "4.475822905897451`*^32", "1.6820078564064078`*^29", "0"},
        {
         SuperscriptBox["k0", "3"], "1", "0.`", "0.`", "0.`", "1.`"},
        {
         RowBox[{
          SuperscriptBox["k0", "2"], " ", "l0"}], "1", 
         "2.941557803443702`*^32", "2.941557803443702`*^32", 
         "1.1054332218878999`*^29", "0"},
        {
         RowBox[{"k0", " ", 
          SuperscriptBox["l0", "2"]}], "1", "2.941557803443748`*^32", 
         "2.941557803443748`*^32", "1.1054332218879173`*^29", 
         "1.972445646629752452116606928562030107601`15.954589770191005*^-847"},
        {
         SuperscriptBox["l0", "3"], "1", "0.`", "0.`", "0.`", "1.`"},
        {
         SuperscriptBox["k0", "4"], "1", "0.`", "0.`", "0.`", "1.`"},
        {
         RowBox[{
          SuperscriptBox["k0", "3"], " ", "l0"}], "1", "0.`", "0.`", "0.`", 
         "1.`"},
        {
         RowBox[{
          SuperscriptBox["k0", "2"], " ", 
          SuperscriptBox["l0", "2"]}], "1", "1.6552264823795983`*^31", 
         "1.6552264823795983`*^31", "6.220317483576093`*^27", "0"},
        {
         RowBox[{"k0", " ", 
          SuperscriptBox["l0", "3"]}], "1", "0.`", "0.`", "0.`", "1.`"},
        {
         SuperscriptBox["l0", "4"], "1", "0.`", "0.`", "0.`", "1.`"},
        {"\<\"Error\"\>", "106", "282066.`", "2661.`", "", ""},
        {"\<\"Total\"\>", "120", "4.062582412248754`*^34", "", "", ""}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
       GridBoxDividers->{
        "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
         "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       
       GridBoxSpacings->{
        "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
      "Grid"], "DialogStyle",
     StripOnInput->False]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.7982775912565737`*^9, 
  3.798277849954315*^9},ExpressionUUID->"9125e3d4-12bc-4744-af65-\
e7efb97780ba"]
}, Open  ]],

Cell["\<\
It is clear looking at the fit residuals only that the fit with rank 4 was \
indeed perfect.\
\>", "Text",
 CellChangeTimes->{{3.798277616314252*^9, 
  3.7982776329343643`*^9}},ExpressionUUID->"909e10d8-dda0-4a47-8a8e-\
571536a8d019"],

Cell["But let\[CloseCurlyQuote]s test them nonetheless:", "Text",
 CellChangeTimes->{{3.798277027808158*^9, 3.798277029348627*^9}, {
  3.798277641815292*^9, 
  3.798277650614373*^9}},ExpressionUUID->"60ea9ad3-6076-46b4-9f99-\
f15df7764d68"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"\"\<Rank 3 fit ratio = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"lm3", "[", "\"\<BestFit\>\"", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"k0", "\[Rule]", "k0In"}], ",", 
           RowBox[{"l0", "\[Rule]", "l0In"}]}], "}"}]}], 
        RowBox[{"MyF", "[", 
         RowBox[{"k0In", ",", "l0In"}], "]"}]], ",", "InputForm"}], "]"}], 
     "<>", "\"\<\\n\>\"", "<>", "\[IndentingNewLine]", 
     "\"\<Rank 4 fit ratio = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"lm4", "[", "\"\<BestFit\>\"", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"k0", "\[Rule]", "k0In"}], ",", 
           RowBox[{"l0", "\[Rule]", "l0In"}]}], "}"}]}], 
        RowBox[{"MyF", "[", 
         RowBox[{"k0In", ",", "l0In"}], "]"}]], ",", "InputForm"}], "]"}]}], 
    ")"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k0In", ",", "10."}], "}"}], ",", "0", ",", "10000"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l0In", ",", "10."}], "}"}], ",", "0", ",", "10000"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.798277031554861*^9, 3.798277115699792*^9}, {
  3.798277653997786*^9, 
  3.7982777298884478`*^9}},ExpressionUUID->"d9c6f5c5-b9d5-4510-a1f9-\
2e2a7fc74884"],

Cell[BoxData[
 FormBox[
  TagBox[
   FormBox[
    StyleBox[
     DynamicModuleBox[{$CellContext`k0In$$ = 5500., $CellContext`l0In$$ = 
      2900., Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
      Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ =
       1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
         Hold[$CellContext`k0In$$], 10.}, 0, 10000}, {{
         Hold[$CellContext`l0In$$], 10.}, 0, 10000}}, Typeset`size$$ = {
      207., {20.25, 9.75}}, Typeset`update$$ = 0, Typeset`initDone$$, 
      Typeset`skipInitDone$$ = True, $CellContext`k0In$8657$$ = 
      0, $CellContext`l0In$8658$$ = 0}, 
      DynamicBox[Manipulate`ManipulateBoxes[
       1, TraditionalForm, 
        "Variables" :> {$CellContext`k0In$$ = 10., $CellContext`l0In$$ = 10.},
         "ControllerVariables" :> {
          Hold[$CellContext`k0In$$, $CellContext`k0In$8657$$, 0], 
          Hold[$CellContext`l0In$$, $CellContext`l0In$8658$$, 0]}, 
        "OtherVariables" :> {
         Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
          Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
          Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
          Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> 
        StringJoin["Rank 3 fit ratio = ", 
          ToString[ReplaceAll[
             $CellContext`lm3[
             "BestFit"], {$CellContext`k0 -> $CellContext`k0In$$, \
$CellContext`l0 -> \
$CellContext`l0In$$}]/$CellContext`MyF[$CellContext`k0In$$, \
$CellContext`l0In$$], InputForm], "\n", "Rank 4 fit ratio = ", 
          ToString[ReplaceAll[
             $CellContext`lm4[
             "BestFit"], {$CellContext`k0 -> $CellContext`k0In$$, \
$CellContext`l0 -> \
$CellContext`l0In$$}]/$CellContext`MyF[$CellContext`k0In$$, \
$CellContext`l0In$$], InputForm]], 
        "Specifications" :> {{{$CellContext`k0In$$, 10.}, 0, 
           10000}, {{$CellContext`l0In$$, 10.}, 0, 10000}}, "Options" :> {}, 
        "DefaultOptions" :> {}],
       ImageSizeCache->{260., {70., 77.}},
       SingleEvaluation->True],
      Deinitialization:>None,
      DynamicModuleValues:>{},
      SynchronousInitialization->True,
      UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
      UnsavedVariables:>{Typeset`initDone$$},
      UntrackedVariables:>{Typeset`size$$}], "Manipulate",
     Deployed->True,
     StripOnInput->False],
    TraditionalForm],
   Manipulate`InterpretManipulate[1]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.798277116365581*^9, 3.798277143597527*^9}, {
   3.79827771582872*^9, 3.7982777312631683`*^9}, 
   3.798277850028161*^9},ExpressionUUID->"71b344dd-d4a4-44bd-b29d-\
51411b552e83"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1187, 1308},
WindowMargins->{{Automatic, 310}, {1175, Automatic}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 445, 9, 160, "Title",ExpressionUUID->"862fd90a-3f33-4861-845a-877f7ac86f05"],
Cell[1028, 33, 294, 4, 35, "Text",ExpressionUUID->"9131fffc-91c9-48f2-8761-6292b0a1a437"],
Cell[1325, 39, 327, 9, 30, "Input",ExpressionUUID->"7de1c9d8-cb26-47e9-8fcb-8b5323b434e1"],
Cell[CellGroupData[{
Cell[1677, 52, 449, 9, 30, "Input",ExpressionUUID->"1cb01a94-6c0a-49a0-831a-6f1cd87e1b31"],
Cell[2129, 63, 959, 15, 366, "Print",ExpressionUUID->"7913f142-4451-4b70-ae92-49bf61b8f0a2"]
}, Open  ]],
Cell[3103, 81, 463, 11, 150, "Text",ExpressionUUID->"335a5b50-5a24-4240-91d3-673def06c326"],
Cell[3569, 94, 323, 8, 30, "Input",ExpressionUUID->"48630be6-9b6d-4fe9-8827-ac59d5b274d4"],
Cell[3895, 104, 233, 4, 35, "Text",ExpressionUUID->"ff9af223-3f92-413c-a15e-24da5de7f653"],
Cell[4131, 110, 338, 8, 30, "Input",ExpressionUUID->"ac899e56-37b3-4844-b613-139b45f8b272"],
Cell[4472, 120, 296, 6, 35, "Text",ExpressionUUID->"c5462f3f-1378-4742-9223-d32bc1cb367f"],
Cell[CellGroupData[{
Cell[4793, 130, 368, 7, 52, "Input",ExpressionUUID->"eba75ea8-2722-4b1d-923b-4cfe08bd1043"],
Cell[5164, 139, 230, 5, 30, "Output",ExpressionUUID->"562a2074-7ba0-454a-b23e-5a4fd5d7833c"],
Cell[5397, 146, 232, 5, 30, "Output",ExpressionUUID->"a45ab2d8-4861-4752-bac2-3dff1388de41"]
}, Open  ]],
Cell[5644, 154, 354, 7, 35, "Text",ExpressionUUID->"a93104a1-9b30-4375-8fba-4ede4874057c"],
Cell[6001, 163, 718, 19, 73, "Input",ExpressionUUID->"d3f9bccd-5d4d-4ee6-b512-fd927b63d83c"],
Cell[6722, 184, 1331, 30, 157, "Input",ExpressionUUID->"8a897906-6230-4be6-8595-3969f88f102f"],
Cell[8056, 216, 183, 3, 35, "Text",ExpressionUUID->"a5a09203-a496-4f2d-8958-6530f7410ac8"],
Cell[8242, 221, 1613, 43, 220, "Input",ExpressionUUID->"fbd794dd-f7fa-418c-a864-22dcf4138012"],
Cell[9858, 266, 234, 6, 35, "Text",ExpressionUUID->"7ddafd91-24b4-4956-9ee1-3e7e1b8edfde"],
Cell[10095, 274, 1825, 47, 115, "Input",ExpressionUUID->"fa15b70b-0e20-4026-b849-5adf074f679c"],
Cell[11923, 323, 203, 3, 35, "Text",ExpressionUUID->"9810aaa8-d163-4947-9511-930a54e03cd0"],
Cell[12129, 328, 824, 22, 30, "Input",ExpressionUUID->"0b1c8d19-f44f-4a95-aa7e-cf0702894b50"],
Cell[12956, 352, 213, 5, 35, "Text",ExpressionUUID->"6a31d113-8438-4780-8393-a37b70ab35b5"],
Cell[CellGroupData[{
Cell[13194, 361, 536, 13, 30, "Input",ExpressionUUID->"9889ce58-8236-4c92-a0ce-39e14b26c87f"],
Cell[13733, 376, 6873, 131, 46, "Output",ExpressionUUID->"708579d1-dca1-4c88-bc6b-6faadb6eb7f3"]
}, Open  ]],
Cell[20621, 510, 187, 3, 35, "Text",ExpressionUUID->"e11d9445-5135-413a-a3a3-d56858899411"],
Cell[CellGroupData[{
Cell[20833, 517, 444, 12, 30, "Input",ExpressionUUID->"27841437-0540-42e2-83d6-e9aed8ba9bb4"],
Cell[21280, 531, 8510, 155, 46, "Output",ExpressionUUID->"d245260d-07d1-424b-841e-df4a005e7e31"]
}, Open  ]],
Cell[29805, 689, 220, 5, 35, "Text",ExpressionUUID->"2cf9bf65-cacc-47b0-a450-de92b3a5876b"],
Cell[CellGroupData[{
Cell[30050, 698, 322, 8, 30, "Input",ExpressionUUID->"e99d9cf0-914b-461f-aeb7-3fa5dad8a2ba"],
Cell[30375, 708, 7562, 142, 478, "Output",ExpressionUUID->"4ca0bd6e-1093-4b66-8a6d-a9963912169e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37974, 855, 300, 8, 30, "Input",ExpressionUUID->"33747149-b5e7-4998-bb74-e96038ce1619"],
Cell[38277, 865, 7035, 184, 405, "Output",ExpressionUUID->"9125e3d4-12bc-4744-af65-e7efb97780ba"]
}, Open  ]],
Cell[45327, 1052, 244, 6, 35, "Text",ExpressionUUID->"909e10d8-dda0-4a47-8a8e-571536a8d019"],
Cell[45574, 1060, 240, 4, 35, "Text",ExpressionUUID->"60ea9ad3-6076-46b4-9f99-f15df7764d68"],
Cell[CellGroupData[{
Cell[45839, 1068, 1547, 43, 174, "Input",ExpressionUUID->"d9c6f5c5-b9d5-4510-a1f9-2e2a7fc74884"],
Cell[47389, 1113, 2701, 56, 166, "Output",ExpressionUUID->"71b344dd-d4a4-44bd-b29d-51411b552e83"]
}, Open  ]]
}, Open  ]]
}
]
*)

