<prologue>


<diagram>
**NewDiagram**
<<|
<back>"edges"->>{
<back><in_loop>in[[<in_index>]]
<back>->>v[[<vertex_index>]],
<back><end>
<back><out_loop>v[[<vertex_index>]]
<back>->>out[[<out_index>]],
<back><end>
<back><propagator_loop>v[[<dual-vertex_index>]]
<back>->>v[[<vertex_index>]],
<back><end>
<back><back>},
<back>"particleType"->>{
<back><in_loop>in[[<field>[[<momentum>]]]],
<back><end>
<back><out_loop>out[[<field>[[<momentum>]]]],
<back><end>
<back><propagator_loop><field>,
<back><end>
<back><back>},
<back>"momentumMap"->>{
<back><in_loop>in[[<momentum>]],
<back><end>
<back><out_loop>out[[<momentum>]],
<back><end>
<back><propagator_loop><momentum>,
<back><end>
<back><back>},
<back>"numerator"->>
<back><sign><symmetry_factor>*
<in_loop> in[[<field>[[<momentum>,<field_index>]] ]]*
<end><out_loop> out[[ <field>[[<momentum>,<field_index>]] ]]*
<end><propagator_loop>
<back>prop[[<field>[[<momentum>,{<field_index>,<dual-field_index>}]] ]]*
<end><back>
<vertex_loop> v [[ <ray_loop>
<back><field>[[<momentum>,<field_index> ]],
<back><end><back>]]*
<end><back><back>,
"python_graph"->>
<<|
"edges"->><<|
<in_loop> ToString[[<in_index>]]->>{
    "name"->>"p<in_index>", 
    "PDG"->> [pdg],
    "type"->> "in",
    "momentum"->> "<momentum>",
    "indices"->> {<field_index>+<legs>+1},
    "vertices"->> {<field_index>+<legs>+1, 
<back><vertex_index>+<legs>}
 },
<end>
<back><out_loop>ToString[[<leg_index>]]->>{
    "name"->> "p<leg_index>",
    "PDG"->> [pdg],
    "type"->> "out",
    "momentum"->> "<momentum>",
    "indices"->> {<field_index>+<legs>+1},
    "vertices"->>{<vertex_index>+<legs>, 
<back><field_index>+<legs>+1}
 },
<end>
<back><propagator_loop>ToString[[<propagator_index>+<legs>]]->>{
    "name"->>"q"<<>>ToString[[<propagator_index>]],
    "PDG"->> [pdg],
    "type"->> "virtual",
    "momentum"->> "<momentum>",
    "indices"->> {<field_index>+<legs>+1,
<back><dual-field_index>+<legs>+1},
    "vertices"->>{<dual-vertex_index>+<legs>,
<back><vertex_index>+<legs>}
 },
<end><back><back>
|>>,
"nodes"->> <<|
<in_loop> ToString[[<field_index>+<legs>+1]]->>{
    "PDGs"->> {[pdg]},
    "momenta"->> {"<momentum>"},
    "indices"->> {<field_index>+<legs>+1},
    "vertex_id"->> -1
 },
<back>
<end>
<back><out_loop> ToString[[<field_index>+<legs>+1]]->>{
    "PDGs"->> {[pdg]},
    "momenta"->> {"<momentum>"},
    "indices"->> {<field_index>+<legs>+1},
    "vertex_id"->> -2
 },
<back>
<end>
<back><vertex_loop>ToString[[ <vertex_index>+<legs>]]->>{
    "PDGs"->> {<ray_loop>[pdg],<end><back>},
    "momenta"->> {<ray_loop>"<momentum>",<end><back>},
    "indices"->> {<ray_loop><field_index>+<legs>+1,<end><back>},
    "vertex_id"->> 0
    },
<end><back><back>
|>>,
"overall_factor"->> "<sign><symmetry_factor>"
|>>
<back>|>>
<epilogue>

<exit>
